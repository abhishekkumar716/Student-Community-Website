<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Community - Student Community</title>
    <link rel="stylesheet" href="style.css">
    
</head>
<style>

header {
    background-color: #333;
    color: #fff;
    padding: 21px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.2);
    position: fixed;
    width: 100%;
    top: 0;
    z-index: 1000;
}

.left-panel {
    background-color: #f4f4f4;
    padding: 20px;
    width: 250px;
    position: fixed;
    top: 70px; /* Height of the header */
    bottom: 0;
    overflow-y: auto;
    z-index: 900;
}

.main-content {
    margin-left: 270px; /* Width of the left panel + some margin */
    padding-top: 90px; /* Height of the header + some padding */
    padding-left: 20px;
    padding-right: 20px;
    flex-grow: 1;
}

#posts-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); /* Adjust min width as needed */
    gap: 20px; /* Adjust gap between posts */
}

.post {
    background-color: #fff;
    padding: 20px;
    box-shadow: 0px 0px 5px rgba(0, 0, 0, 0.2);
    height: 300px; /* Set a fixed height for all posts */
    overflow: hidden; /* Hide overflow content */
    display: flex;
    flex-direction: column;
    justify-content: space-between;
}

.post p {
    margin-bottom: 10px;
    flex-grow: 1; /* Allow paragraph to grow within the post */
}

.post img {
    max-width: 100%;
    height: auto;
    display: block;
    margin: auto; /* Center image horizontally */
}

.posted-by {
    margin-top: 20px;
    text-align: center;
}



@media (max-width: 768px) {
    .left-panel {
        position: static;
        width: 100%;
        height: auto;
        padding-top: 20px;
    }

    .main-content {
        margin-left: 0;
        padding-top: 100px; /* Adjust for header */
    }
}

@media (max-width: 480px) {
    header, footer {
        padding: 10px;
    }

    .left-panel {
        padding: 10px;
    }

    .main-content {
        padding: 10px;
    }

    .post {
        padding: 10px;
    }
}
#logout-btn {
    position: fixed;
    top: 20px;
    right: 20px;
}
table {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
        font-size: 18px;
        text-align: left;
    }

    table, th, td {
        border: 1px solid #dddddd;
    }

    th, td {
        padding: 12px;
    }

    th {
        background-color: #f2f2f2;
    }

    .registration-list {
        margin-top: 20px;
    }

</style>
<body onload="dashboard()">
    <header>
        <div class="logo">
            <h1>Student Community</h1>
        </div>
        <nav>
            <ul>
                <div class="cta-buttons">
                    <li><a href="#" onclick="logout()" id="logout-btn">Logout</a></li>
                </div>
            </ul>
        </nav>
    </header>

    <div class="left-panel">
        <h2>Admin Options</h2>
        <ul>
            <li><a href="#" onclick="dashboard()">Dashboard</a></li>
            <li><a href="#" onclick="viewPosts()">View Posts</a></li>
            <li><a href="#" onclick="addEvent()">Add Event</a></li>
            <li><a href="#" onclick="viewRegistrations()">View Registrations</a></li>
        </ul>
    </div>

    <div class="main-content">
        <main class="login-container">
            <section id="post-form">
                <h2>Create a Post</h2>
                <textarea id="post-content" placeholder="Write your caption" required></textarea>
                <input type="file" id="post-image" accept="image/*" required>
                <button onclick="createPost()">Post</button>
            </section>
        </main><br>
        <section id="posts-container">
            <!-- Posts will be dynamically inserted here -->
        </section> 
    </div>
        
    <footer>
        <p>&copy; 2024 Student Community</p>
    </footer>

    <script src="script.js"></script>
    <script>
        function logout() {
            window.location.href = "index.html";
        }

        function dashboard() {
            window.location.href = "admincommunities.html";
        }

        function addEvent() {
            window.location.href = "event.html";
        }

        function createPost() {
            var content = document.getElementById("post-content").value;
            var image = document.getElementById("post-image").files[0];
            var reader = new FileReader();

            reader.onloadend = function() {
                var posts = JSON.parse(localStorage.getItem("posts")) || [];
                var post = {
                    content: content,
                    image: reader.result,
                    email: "admin" // Replace with dynamic admin email
                };
                posts.unshift(post);
                localStorage.setItem("posts", JSON.stringify(posts));
                displayPost(post);
            };

            if (image) {
                reader.readAsDataURL(image);
            }
        }

        function displayPost(post) {
            var postsContainer = document.getElementById("posts-container");
            var postElement = document.createElement("div");
            postElement.className = "post";
            postElement.innerHTML = `
                <img src="${post.image}" alt="Post image">
                <p>${post.content}</p>
                <div class="posted-by">Posted by: ${post.email}</div>
            `;
            postsContainer.prepend(postElement);
        }

        window.onload = function() {
            var posts = JSON.parse(localStorage.getItem("posts")) || [];
            posts.forEach(function(post) {
                displayPost(post);
            });
        }

        function viewRegistrations() {
    var contentContainer = document.querySelector('.main-content');
    contentContainer.innerHTML = '';
    
    var heading = document.createElement('h2');
    heading.textContent = 'Registrations';
    contentContainer.appendChild(heading);
    
    var registrations = JSON.parse(localStorage.getItem("registrations")) || [];
    if (registrations.length === 0) {
        contentContainer.innerHTML += '<p>No registrations found.</p>';
    } else {
        var table = document.createElement('table');
        var thead = document.createElement('thead');
        var tbody = document.createElement('tbody');

        var headerRow = document.createElement('tr');
        var headers = ['Name', 'Roll Number', 'Sport'];
        headers.forEach(function(header) {
            var th = document.createElement('th');
            th.textContent = header;
            headerRow.appendChild(th);
        });
        thead.appendChild(headerRow);

        registrations.forEach(function(registration) {
            var row = document.createElement('tr');

            var nameCell = document.createElement('td');
            nameCell.textContent = registration.name;
            row.appendChild(nameCell);

            var rollNoCell = document.createElement('td');
            rollNoCell.textContent = registration.rollNo;
            row.appendChild(rollNoCell);

            var sportCell = document.createElement('td');
            sportCell.textContent = registration.sport;
            row.appendChild(sportCell);

            tbody.appendChild(row);
        });

        table.appendChild(thead);
        table.appendChild(tbody);
        contentContainer.appendChild(table);

        // Add download button
        var downloadButton = document.createElement('button');
        downloadButton.textContent = 'Download Registrations';
        downloadButton.addEventListener('click', function() {
            downloadRegistrations(registrations);
        });
        contentContainer.appendChild(downloadButton);
    }
}

function downloadRegistrations(registrations) {
    var filename = 'registrations.csv';
    var csv = 'Name,Roll Number,Sport\n';
    registrations.forEach(function(registration) {
        csv += registration.name + ',' + registration.rollNo + ',' + registration.sport + '\n';
    });

    var blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
    if (navigator.msSaveBlob) { // IE 10+
        navigator.msSaveBlob(blob, filename);
    } else {
        var link = document.createElement('a');
        if (link.download !== undefined) {
            var url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', filename);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    }
}


    </script>
</body>
</html>
